using System;
using System.Collections.Generic;
using System.Windows.Forms;
using System.Threading;
using System.Diagnostics;
using System.Text;
using System.Runtime.InteropServices;
using log4net;
using System.Reflection;
using Maticsoft.BLL.log;
using Maticsoft.BLL.proController;
using Maticsoft.Common.model;
using System.IO.Ports;
using Maticsoft.BLL.comparison;
using System.Globalization;

//[assembly: log4net.Config.XmlConfigurator(Watch = true)]
//[assembly: log4net.Config.XmlConfigurator(ConfigFile = "Demo.exe.config", ConfigFileExtension = "xml", Watch = true)]
namespace Demo
{
    static class Program
    {
        [DllImport("user32.dll")]
        public static extern IntPtr FindWindow(string lpClassName, string lpWindowName);
        [DllImport("user32.dll ", SetLastError = true)]
        static extern void SwitchToThisWindow(IntPtr hWnd, bool fAltTab);
        [DllImport("user32.dll", EntryPoint = "ShowWindow", CharSet = CharSet.Auto)]
        public static extern int ShowWindow(IntPtr hwnd, int nCmdShow);
        public const int SW_RESTORE = 9;
        public static IntPtr formhwnd; 

        /// <summary>
        /// 应用程序的主入口点。
        /// </summary>
        [STAThread]
        static void Main()
        {
//            String re = String.Empty;
//            String reInfo = @"体彩<超级大乐透>
//110618-719800-066458-609812 513110 E/CtSg
//第 16037期    共15期       16/04/02开奖
//13-013271-101 00182     16/03/31 16:47:22
//胆拖票 1倍 合计450元
//前区胆 01 03 04  .  .  .  .
//前区拖 07 08 10 14 25 26  .
//后区胆  .  .  .  .  .  .  .
//后区拖 05 08  .  .  .  .  .
//
//
//大乐透奖池25.86亿，3元最高可中1600万。
//竞彩01日 08:30 桑托斯 vs 阿拉拉夸拉铁路
//渭滨区孔家庄村";
//            lottery_ticket lt = new lottery_ticket();
//            lt.license_id = 9;
//            lt.play_type = "6-2c1";
//            lt.issue = "16032933";
//            lt.multiple = "1";
//            lt.bet_price = "12";
//            ComparisonUtil.comparisonFunction(lt, reInfo, out re);

            //            //测试解析用
            //try
            //{

            //SerialPort sp = new SerialPort();
            //store_machine sm = new store_machine();
            //sm.machine_code = "1111";
            //SerialPortInfo spi = new SerialPortInfo(sp, sm);
            //BaseProController bpc = new BaseProController(spi);
            //bpc.testRead();
            //return;
            //}
            //catch (Exception e)
            //{
            //    throw e;
            //}

            //            BaseTicketInfoComparison itc = new LDR900AComparison();
            //            String ticketInfo = @"体彩<超级大乐透>
            //110378-530600-052668-252907 671514 EB+gJQ
            //第 16013期    共1期         16/01/30开奖
            //20-020291-101 00060     16/01/29 12:16:44
            //复式票 1倍 合计6元
            //  前 区 03 13 26 27 28  .  .
            //  后 区 08 09 11  .  .  .  .
            //玩体彩“手机在线” 送1500万元红包！
            //竞彩29日 22:45 卡塔尔U23VS伊拉克U23
            //山东省武城县第二幼儿园北邻";
            //            lottery_ticket lt = new lottery_ticket();
            //            lt.license_id = 4;
            //            lt.bet_price = "6";
            //            lt.play_type = "2";

            //            lt.issue = "16013";
            //            lt.multiple = "1";

            //            ((ITicketInfoComparison)itc).getAllComparedItems(ticketInfo, lt);
            //            String com = String.Empty;
            //            Boolean a = ((ITicketInfoComparison)itc).simpleComparison(lt, ref com);
            //return;
            //打开日志处理线程
            //LogUtil.getInstance().init();

            //Application.EnableVisualStyles();
            //Application.SetCompatibleTextRenderingDefault(false);
            //string proc = Process.GetCurrentProcess().ProcessName;
            //Process[] processes = Process.GetProcessesByName(proc);
            //if (processes.Length <= 1)
            //{
            //    //Application.Run(new FrmMain1());
            //    Login form = new Login();
            //    form.ShowDialog();
            //    if (form.DialogResult == DialogResult.OK)
            //    {
            //        form.Close();
            //        form.Dispose();
            //        Application.Run(new FrmMain());
            //    }
            //    else
            //    {
            //        Application.Exit();
            //    }

            //}
            //else
            //{
            //    for (int i = 0; i < processes.Length; i++)
            //    {
            //        if (processes[i].Id != Process.GetCurrentProcess().Id)
            //        {
            //            if (processes[i].MainWindowHandle.ToInt32() == 0)
            //            {
            //                formhwnd = FindWindow(null, "FrmMain");
            //                ShowWindow(formhwnd, 1);
            //                SwitchToThisWindow(formhwnd, true);
            //            }
            //            else
            //            {
            //                SwitchToThisWindow(processes[i].MainWindowHandle, true);
            //            }
            //        }
            //    }
            //}
            Application.Run(new Test());
        }
    }
}
